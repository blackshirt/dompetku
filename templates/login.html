{% extends "base.html" %}

{% block content %}
<form action="{{ request.path }}" method="post" id="login-form">
    {% autoescape None %}
    <h2 class="form-signin-heading">Please sign in</h2>
    {% for field in form %}
        <div class="form-group">
            {{ field.label(class_="form-label") }}
            {{ field(class_="form-control input-lg") }}
            {% if field.errors %}
                {% for error in field.errors %}
                    <div class="form-group help-block has-warning"><span style="color: blue;"> {{error}} </span> </div>
                {% end %}
            {% end %}
        </div>
    {% end %}
    <input type="submit" class="btn btn-default btn-md" value="{{ _("Next to Log in") }}" />
    {% module xsrf_form_html() %}
</form>
{% end %}

{% block script %}
<script type="text/javascript">
    $(document).ready(function() {
        $('#login-form').bootstrapValidator({
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                name: {
                    validators: {
                        notEmpty: {
                            message: 'Username is required'
                        },

                        remote: {
                            url: '/api/check/user',
                            message: 'The username is not available'
                        }

                    }
                },
                password: {
                    validators: {
                        notEmpty: {
                            message: 'User password is required'
                        },

                        remote: {
                            url: '/api/check/password',
                            message: 'Password not match'
                        }
                    }
                },
            }
        })
    });
</script>
{% end %}

